# For this project, I downloaded a chinook database
# which represents a digital media store and
# opened the dataset in SQLite Studio.

# First, I wanted to list all the Customers of chinook
# who are not from the US, as well as those from 
# Brazil with their CustomerId and Email.

SELECT FirstName, LastName, CustomerId, Country
FROM chinook.customers
WHERE Country <> 'USA'
ORDER BY CustomerId;

SELECT FirstName, LastName, CustomerId, Country, Email
FROM chinook.customers
WHERE Country = 'Brazil'
ORDER BY CustomerId;

# Next, I displayed the Invoice information of customers in Brazil.

SELECT customers.FirstName, customers.LastName, 
invoices.InvoiceId, invoices.InvoiceDate, invoices.BillingCountry
FROM chinook.customers
LEFT JOIN chinook.invoices ON customers.CustomerId=invoices.CustomerId
WHERE invoices.BillingCountry='Brazil';

# Then, I wanted to know which Employees held the title of Sales Support Agent
# which invoices/Customer they were associated with, and the total of their invoice.

SELECT EmployeeId, LastName, FirstName,
BirthDate, HireDate
FROM chinook.employees
WHERE Title='Sales Support Agent';

SELECT emp.FirstName, emp.LastName, Inv.InvoiceId, 
cust.CustomerId, cust.FirstName, cust.LastName, Inv.Total
FROM chinook.employees AS emp
JOIN chinook.customers cust ON cust.SupportRepId=emp.EmployeeId
JOIN chinook.invoices Inv ON Inv.CustomerId=cust.CustomerId;

# For the sum of invoices from 2009 as well as the total paid for that year:

SELECT COUNT(*)
FROM chinook.invoices
WHERE InvoiceDate LIKE '2009%';

SELECT SUM(Total)
FROM chinook.invoices
WHERE InvoiceDate LIKE '2009%';

# For the purchased song tracks with the Artist's name and Invoice ID:

SELECT ar.name as Artist, t.Name as Track, i.InvoiceLineId
FROM chinook.Invoice_items i
LEFT JOIN chinook.tracks t 
ON i.TrackID=t.TrackID
INNER JOIN chinook.albums a
ON a.AlbumID=t.AlbumID
LEFT JOIN chinook.artists ar
ON ar.ArtistID=a.ArtistID;

# For a detailed breakdown on each song with their Album Name, Composer,
# Price, and Media Type:

SELECT t.Name AS 'Track Name', a.Title AS 'Album Title', m.Name AS 'Media Type', g.Name AS 'Genre'
FROM chinook.tracks t
JOIN chinook.Albums a 
on a.AlbumId = t.AlbumId
JOIN chinook.Media_Types m
on m.MediaTypeId = t.MediaTypeId
JOIN chinook.Genres g
on g.GenreId = t.GenreId;
